stateDiagram-v2
  direction LR
  [*] --> Idle
  Idle --> PROCESSING : sink_sop = 1 & sink_valid = 1\nsource_valid = 1, source_data = sink_data
  PROCESSING --> BACKPRESSURE : sink_ready = 0 (Backpressure)\nbyte_counter += 1, source_valid = 1
  PROCESSING --> ZERO_PADDING : sink_eop = 1 & cell_incomplete = 1\nsource_data = 0x00 (Zero Padding)
  PROCESSING --> Idle : sink_eop = 1 & cell_incomplete = 0\nsource_eoc = 1
  PROCESSING --> PROCESSING : continue processing\nbyte_counter += 1, source_valid = 1
  BACKPRESSURE --> PROCESSING : sink_ready = 1\nsource_valid = 0
  BACKPRESSURE --> ZERO_PADDING : sink_eop = 1 & cell_incomplete = 1\nsource_data = 0x00
  BACKPRESSURE --> BACKPRESSURE : hold state\nsink_ready = 0
  ZERO_PADDING --> Idle : padding_complete = 1\nsource_eoc = 1, padding_complete

  state Idle {
    [*] --> Idle_state
    Idle_state --> [*] : state <= Idle
  }

  state PROCESSING {
    [*] --> PROCESSING_state
    PROCESSING_state --> [*] : state <= PROCESSING
  }

  state BACKPRESSURE {
    [*] --> BACKPRESSURE_state
    BACKPRESSURE_state --> [*] : state <= BACKPRESSURE
  }

  state ZERO_PADDING {
    [*] --> ZERO_PADDING_state
    ZERO_PADDING_state --> [*] : state <= ZERO_PADDING
  }
